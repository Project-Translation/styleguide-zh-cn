# 文档最佳实践

“简单直接地说出你的意思。” -
[Brian Kernighan](https://en.wikipedia.org/wiki/The_Elements_of_Programming_Style)

目录：

1.  [最小可行文档](#最小可行文档)
1.  [与代码一起更新文档](#与代码一起更新文档)
1.  [删除无效文档](#删除无效文档)
1.  [选择良好而非完美](#选择良好而非完美)
1.  [文档是代码的故事](#文档是代码的故事)
1.  [重复是邪恶的](#重复是邪恶的)

## 最小可行文档

一小套新鲜且准确的文档要比一堆处于不同维护状态的“文档”更好。

编写简短且有用的文档。删除所有不必要的内容，包括过时的、不正确的或冗余的信息。还要养成习惯，不断地调整和改进每份文档，以适应你不断变化的需求。**文档在保持活跃但经常修剪时效果最佳，就像一棵盆景树**。

另见
[这些敏捷文档最佳实践](https://www.agilemodeling.com/essays/agileDocumentationBestPractices.htm)。

## 与代码一起更新文档

**在与代码变更相同的CL中更改文档**。这能保持文档的新鲜度，同时也是向审阅者解释你在做什么的好地方。

一个好的审阅者至少可以坚持要求更新文档字符串、头文件、README.md文件以及任何其他与CL一起更新的文档。

## 删除无效文档

无效文档是坏的。它们会误导、拖慢进度、激发工程师的绝望和团队领导的懒惰。它们为在代码库中留下混乱树立了先例。如果你的家很干净，大多数客人也会在不被要求的情况下保持干净。

就像任何大型清洁项目一样，**很容易感到不知所措**。如果你的文档状况不佳：

*   慢慢来，文档健康是一个逐渐积累的过程。
*   首先删除你确定是错误的部分，忽略不清楚的部分。
*   让整个团队参与进来。花时间快速扫描每份文档，并做出简单的决定：保留还是删除？
*   默认选择删除或在迁移时留下。落单的文档总是可以恢复的。
*   迭代。

## 选择良好而非完美

文档是一门艺术。没有完美的文档，只有经过验证的方法和审慎的指导原则。参见[优良胜过最佳](./style.md)。

## 文档是代码的故事

编写优秀的代码并不在你的代码编译完成或测试覆盖率达到100%时结束。写出计算机能理解的东西很容易，写出人类和计算机都能理解的东西却难得多。作为一个关注代码健康的工程师，你的使命是**先为人类写，再为计算机写**。文档是这项技能的重要组成部分。

工程文档的范围从简短的注释到详细的散文：

1.  **有意义的命名**：好的命名允许代码传达原本需要通过注释或文档传达的信息。这包括所有级别的可命名实体，从局部变量到类、文件和目录。

2.  **内联注释**：内联注释的主要目的是提供代码本身无法包含的信息，例如代码存在的理由。

3.  **方法和类注释**：

    *   **方法API文档**：头部/Javadoc/文档字符串注释，说明方法的功能和使用方法。这份文档是**你的代码必须遵守的契约**。目标受众是未来将使用和修改你的代码的程序员。

        通常可以合理地说，任何在这里记录的行为都应该有一个验证它的测试。这份文档详细说明了方法接受哪些参数，返回什么，任何“陷阱”或限制，以及它可能抛出的异常或返回的错误。除非这对开发者理解如何使用方法相关，否则通常不会解释代码为何以特定方式行为。“为何”解释是为内联注释准备的。在编写方法文档时要以实用角度思考：“这是一把锤子。你用它来钉钉子。”

    *   **类/模块API文档**：类或整个文件的头部/Javadoc/文档字符串注释。这份文档简要概述了类/文件的功能，通常会提供几个简短的使用示例。

        当类有多种不同的使用方式时（一些高级，一些简单），示例特别相关。始终先列出最简单的用例。

4.  **README.md**：一个好的README.md能帮助新用户了解目录，并指向更详细的解释和用户指南：

    *   这个目录打算存放什么？
    *   开发者应该先查看哪些文件？有些文件是API吗？
    *   谁维护这个目录？我在哪里可以了解更多？

    参见[README.md指南](READMEs.md)。

5.  **docs**：一个好的docs目录内容解释了如何：

    *   开始使用相关的API、库或工具。
    *   运行其测试。
    *   调试其输出。
    *   发布二进制文件。

6.  **设计文档、PRD**：一个好的设计文档或PRD详细讨论了提议的实现，以便收集对该设计的反馈。然而，一旦代码实现，设计文档应作为这些决策的档案，而不是半正确的文档（它们经常被误用）。

7.  **其他外部文档**：一些团队在代码之外的其他位置维护文档，例如Google Sites、Drive或wiki。如果你确实维护其他位置的文档，你应该从你的项目目录中明确指向这些位置（例如，通过在项目`README.md`中添加一个明显的链接到该位置）。

## 重复是邪恶的

不要编写你自己的常用Google技术或流程指南。链接到它即可。如果指南不存在或严重过时，向适当的目录提交你的更新或创建一个包级别的README.md。**承担责任，不要害羞**：其他团队通常会欢迎你的贡献。